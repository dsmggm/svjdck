# 账户登录API
后期会进行加密处理，API仅做为参考使用。  
API更新日期：20241211  
  
## 1、发送验证码

- **请求 URL**: `/sendcode`
- **请求方法**: `POST`
- **请求体**:
```json
{
  "username": "手机号"
}
```
- **响应**:
  - **状态码**: `200`
  - **响应体**:
```json
{
  "msg": "验证码发送成功"
}
```
- **响应**:
  - **状态码**: `500`
  - **响应体**:
```json
{
  "msg": "{失败原因}"
}
```

## 2、提交验证码登录

- **请求 URL**: `/verifycode`
- **请求方法**: `POST`
- **请求体**:

```json
{
  "username": "手机号",
  "code": "验证码"
}
```

- **响应**:
  - **状态码**: `200`
  - **响应体**:
```json
{
  "msg": "登录成功",
  "password": "用户密码",
  "remarks": "备注",
  "uid": "UID",
  "pt_pin": "jd_pt_pin",
  "pt_key": "jd_pt_key"
}
```

- **响应**:
  - **状态码**: `202`
  - **响应体**:
```json
{
  "msg": "验证码错误，请重新输入"
}
```

- **响应**:
  - **状态码**: `500`
  - **响应体**:
```json
{
  "msg": "{失败原因}"
}
```

## 3、提交登录信息

- **请求 URL**: `/submit_user_info`
- **请求方法**: `POST`
- **请求体**:

```json
{
  "username": "手机号",
  "remark": "备注",
  "password": "jd账户密码",
  "uid": "UID"
}
```

- **响应**:
  - **状态码**: `200`
  - **响应体**:
```json
{
  "msg": "提交成功"
}
```

- **响应**:
  - **状态码**: `500`
  - **响应体**:
```json
{
  "msg": "{失败原因}"
}
```

## 4、获取WxPusher扫码关注二维码

- **请求 URL**: `/wxpusher_qrcode`
- **请求方法**: `POST`
- **请求体**:

```json
{
  "username": "手机号"
}
```

- **响应**:
  - **状态码**: `200`
  - **响应体**:
```json
{
  "data": {
    "shortUrl": "二维码src"
  }
}
```

- **响应**:
  - **状态码**: `500`
  - **响应体**:
```json
{
  "msg": "{失败原因}"
}
```




# 后台管理API
后期会进行加密处理，API仅做为参考使用。  
API更新日期：20241104  
cookie有效期1800秒，每次请求都会刷新时间  

## 1、登录后台

- **请求 URL**: `/admin/login`
- **请求方法**: `POST`
- **请求体**:

```json
{
  "adminname": "后台账户",
  "adminpasswd": "后台密码"
}
```

- **响应**:
  - **状态码**: `200`
  - **响应头**: `token: token`
  - **响应体**:
```json
{
  "msg": "登录成功"
}
```

- **响应**:
  - **状态码**: `202`
  - **响应体**:
```json
{
  "msg": "账号或密码错误"
}
```

- **响应**:
  - **状态码**: `500`
  - **响应体**:

```json
{
  "msg": "{失败原因}"
}
```

## 2、获取后台配置信息

- **请求 URL**: `/admin_set/init`
- **请求方法**: `POST`
- **请求头**:`Cookie: token`

- **响应**:
  - **状态码**: `200`
  - **响应体**:
```json
{
  "ver": "版本号",
  "apptoken": "wxpusher_apptoken",
  "gg": "公告内容",
  "pushtext": "推送附加信息",
  "auth_date": "授权到期时间",
  "https_status": "https状态",
  "restart_hour": "重启-时",
  "restart_minute": "重启-分",
}
```

- **响应**:
  - **状态码**: `401`
  - **响应体**:
```json
{
  "msg": "未登录或登陆状态过期"
}
```

- **响应**:
  - **状态码**: `500`
  - **响应体**:
```json
{
  "msg": "{失败原因}"
}
```


## 3、保存配置信息

- **请求 URL**: `/admin/set_save`
- **请求方法**: `POST`
- **请求头**:`Cookie: token`
- **请求体**:
```json
{
  "apptoken": "wxpusher_apptoken",
  "gg": "公告内容",
  "pushtext": "推送附加信息",
  "https_status": "https状态"
}
// restart_hour与restart_minute后期会加入
```

- **响应**:
  - **状态码**: `200`
  - **响应体**:
```json
{
  "msg": "保存成功"
}
```

- **响应**:
  - **状态码**: `401`
  - **响应体**:
```json
{
  "msg": "未登录或登陆状态过期"
}
```

- **响应**:
  - **状态码**: `500`
  - **响应体**:
```json
{
  "msg": "{失败原因}"
}
```


## 4、获取后台账号

- **请求 URL**: `/admin/users_list`
- **请求方法**: `POST`
- **请求头**:`Cookie: token`

- **响应**:
  - **状态码**: `200`
  - **响应体**:
```json
[
  [
    2,
    "手机号",
    "密码",
    "备注",
    "UID",
    "jd_pt_pin",
    "1启用，0禁用",
    "最后一次的登录状态",
    "最后一次获取到的pt_key"
  ],
  ...
  [
    99,
    "手机号",
    "密码",
    "备注",
    "UID",
    "jd_pt_pin",
    "1启用，0禁用",
    "最后一次的登录状态",
    "最后一次获取到的pt_key"
  ]
]
```

- **响应**:
  - **状态码**: `401`
  - **响应体**:
```json
{
  "msg": "未登录或登陆状态过期"
}
```

## 5、更改账户信息

- **请求 URL**: `/admin/update_user_info`
- **请求方法**: `POST`
- **请求头**:`Cookie: token`
- **请求体**:
```json
{
  "passwd_value": "密码",
  "pt_pin": "jd_pt_pin",
  "remarks_value": "备注",
  "status": 1,
  "user_value": "账号",
  "uuid_value": "UID"
}
```

- **响应**:
  - **状态码**: `200`
  - **响应体**:
```json
{
  "msg": "保存成功",
}
```

- **响应**:
  - **状态码**: `401`
  - **响应体**:
```json
{
  "msg": "未登录或登陆状态过期"
}
```

- **响应**:
  - **状态码**: `500`
  - **响应体**:
```json
{
  "msg": "{失败原因}"
}
```

## 6、删除用户

- **请求 URL**: `/admin/delete_user`
- **请求方法**: `POST`
- **请求头**:`Cookie: token`
- **请求体**:
```json
{
  "username": "账号"
}
```

- **响应**:
  - **状态码**: `200`
  - **响应体**:
```json
{
  "msg": "删除成功",
}
```

- **响应**:
  - **状态码**: `401`
  - **响应体**:
```json
{
  "msg": "未登录或登陆状态过期"
}
```

- **响应**:
  - **状态码**: `500`
  - **响应体**:
```json
{
  "msg": "{失败原因}"
}
```


## 7、请求更新

- **请求 URL**: `/admin/update`
- **请求方法**: `POST`
- **请求头**:`Cookie: token`

- **响应**:
  - **状态码**: `200`
  - **响应体**:
```json
{
  "msg": "请求成功",
}
```

- **响应**:
  - **状态码**: `401`
  - **响应体**:
```json
{
  "msg": "未登录或登陆状态过期"
}
```

- **响应**:
  - **状态码**: `500`
  - **响应体**:
```json
{
  "msg": "{失败原因}"
}
```

## 8、启用全部账号

- **请求 URL**: `/admin/enable_all_users`
- **请求方法**: `POST`
- **请求头**:`Cookie: token`

- **响应**:
  - **状态码**: `200`
  - **响应体**:
```json
{
  "msg": "启用成功",
}
```

- **响应**:
  - **状态码**: `401`
  - **响应体**:
```json
{
  "msg": "未登录或登陆状态过期"
}
```

- **响应**:
  - **状态码**: `500`
  - **响应体**:
```json
{
  "msg": "{失败原因}"
}
```


## 9、请求重启

- **请求 URL**: `/admin/restart`
- **请求方法**: `POST`
- **请求头**:`Cookie: token`

- **响应**:
  - **状态码**: `200`
  - **响应体**:
```json
{
  "msg": "完成重启请求",
}
```

- **响应**:
  - **状态码**: `401`
  - **响应体**:
```json
{
  "msg": "未登录或登陆状态过期"
}
```

- **响应**:
  - **状态码**: `500`
  - **响应体**:
```json
{
  "msg": "{失败原因}"
}
```



## 10、服务状态检测

- **请求 URL**: `/health`
- **请求方法**: `GET`

- **响应**:
  - **状态码**: `200`
```json
  "ok"
```