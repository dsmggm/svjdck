function savesettings(){let e=document.getElementById("crontab_time").value,t=document.getElementById("apptoken").value,n=document.getElementById("gg").value,o=document.getElementById("sendtext").value,d=document.getElementById("savesettings");d.textContent="保存中...",d.disabled=!0,fetch("/admin_set/save",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({crontab_time:e,apptoken:t,gg:n,sendtext:o})}).then(t=>{t.json().then(e=>{200===t.status?(console.log("Success:",e),d.textContent="保存",d.disabled=!1):201===t.status?(console.log("Forbidden:",t),window.location.href="/admin"):(console.error("Error:",t),d.textContent="保存",d.disabled=!1,alert(e.msg))})}).catch(e=>{console.error("网络错误或其他错误:",e),d.textContent="保存",d.disabled=!1,alert("请求失败，可能网络错误，请重试或联系管理员。",e)})}function update_all(){fetch("/admin_set/update_all",{method:"POST",credentials:"include"}).then(t=>{t.json().then(e=>{200===t.status?(console.log("Success:",e),alert(e.msg)):201===t.status?console.log("Forbidden:",t):console.error("Error:",t)})}).catch(e=>{console.error("Fetch Error:",e)})}function init_set_value(){fetch("/admin_set/init",{method:"POST",credentials:"include"}).then(a=>{a.json().then(e=>{var t,n,o,d,s;200===a.status?(console.log("Success:",e),t=e.crontab_time,n=e.apptoken,o=e.gg,d=e.sendtext,s=e.ver,e=e.auth_date,document.getElementById("crontab_time").value=t[0],document.getElementById("apptoken").value=n[0],document.getElementById("gg").value=o,document.getElementById("sendtext").textContent=d[0],document.getElementById("ver").textContent="当前版本："+s,document.getElementById("auth_date").textContent="授权到期日期："+e):201===a.status?(console.log("Forbidden:",a),window.location.href="/admin"):console.error("Error:",a)})}).catch(e=>{console.error("Fetch Error:",e)})}document.addEventListener("DOMContentLoaded",init_set_value);